# Prototype Template: Spec-Driven AI Software Factory

This repository is a reusable template for building small prototypes using a **spec-driven workflow**:
- Write an idea in English
- Generate a structured spec (`SPEC.md`)
- Have an agentic builder implement the spec
- Run deterministic acceptance checks to verify success

The goal is to reduce “AI chatting” and replace it with a repeatable pipeline where **done** is defined by a pass/fail exit code.

---

## What this template provides
### Workflow stages
1. **Plan (Architect):** Generate a structured spec (`SPEC.md`) from a natural-language prompt.
2. **Build (Builder):** Run an autonomous code agent to implement the spec.
3. **Verify (Inspector):** Run acceptance checks extracted from the spec.

### Key properties
- **Spec as a contract:** `SPEC.md` is the single source of truth for what to build and how to verify it.
- **Deterministic verification:** Acceptance checks are executed by scripts with binary success/failure.
- **Safety guardrails:** The builder refuses to run if the git working tree is dirty (prevents accidental overwrites).

---

## Requirements
- Bash
- Git
- OpenAI Codex CLI (`codex`)
- Docker + Docker Compose (for specs that use containers)
- Standard Unix tools (sed, grep, etc.)

---

## Repository structure (high-level)
- `SPEC.md` — The specification artifact generated by the planner.
- `tools/ai/plan.sh` — Planner wrapper that produces `SPEC.md`.
- `tools/ai/build_from_spec.sh` — Builder wrapper that runs Codex against the spec.
- `tools/ai/run_acceptance.sh` — Acceptance runner that parses and executes commands from `SPEC.md`.
- `Makefile` — Convenience targets (often includes `make acceptance`).

---

## Quickstart

### 1) Create a spec
Run the planner to produce a new `SPEC.md`:
\`\`\`bash
./tools/ai/plan.sh "Create a docker-compose app with make up/reset/test/demo targets"
\`\`\`

### 2) Build from the spec
Run the builder to implement SPEC.md:
\`\`\`bash
./tools/ai/build_from_spec.sh
\`\`\`

### 3) Verify acceptance
Run the acceptance checks defined in the spec:
\`\`\`bash
make acceptance
# or:
./tools/ai/run_acceptance.sh SPEC.md
\`\`\`

## Safety: Git guardrail
`tools/ai/build_from_spec.sh` refuses to run if there are uncommitted changes. This prevents AI automation from overwriting work you haven’t checkpointed.

**Safety drill:**
\`\`\`bash
echo "trash" > junk.txt
./tools/ai/build_from_spec.sh   # should refuse
rm junk.txt
\`\`\`

## License
Unlicensed for internal use.
